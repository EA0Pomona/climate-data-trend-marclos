---
title: "A Look at Climate Change in Oklahoma"
author: "Claudia Chandra"
date: "02/20/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r importingCSV, echo=FALSE, results='hide'}
# Importing Scripts

file = "/home/CAMPUS/mwl04747/github/Climate_Change_Narratives/Data/Los Angeles_878024.csv"

import = read.csv(file)
```


```{r checking, echo=FALSE, results='hide'}
#plot(TMAX~DATE, import)
```


```{r missings, echo=FALSE}
import$TMAX[import$TMAX==-9999] = NA
import$TMIN[import$TMIN==-9999] = NA
```




```{r, echo=FALSE, results='hide'}
strDates <- as.character(import$DATE)
head(strDates)
import$NewDate <- as.Date(strDates, "%Y%m%d")
```




```{r, echo=FALSE, results='hide'}
unique(import$STATION_NAME)
```


```{r, echo=FALSE}
LosAngeles <- subset(import, STATION_NAME=="LOS ANGELES DOWNTOWN USC CA US", select=c(STATION, STATION_NAME, DATE, NewDate, TMIN, TMAX, PRCP))
```
 

```{r, echo=FALSE, results='hide'}
LosAngeles$Month = months(LosAngeles$NewDate) # Creates problems.
LosAngeles$Month = format(as.Date(LosAngeles$NewDate), format = "%m")
LosAngeles$Year = format(LosAngeles$NewDate, format="%Y")
```

```{r creatingmonthlymeans, echo=FALSE, results='hide'}
MonthlyMean = aggregate(TMAX ~ Month + Year, LosAngeles, mean)

MonthlyMean$YEAR = as.numeric(MonthlyMean$Year)
MonthlyMean$MONTH = as.numeric(MonthlyMean$Month)
```

All environmental changes observed in the last 150 years have been influenced by a 2°F increase in global land and sea temperature. Extensive climate change research has been undertaken for different regions of the United States; and although results and predictions vary, there is unanimity in the belief that for Oklahoma, the “magnitude of expected changes will exceed those experienced in the last century (Ojima). Despite this, 25% of Oklahoma’s residents believe global warming to be a myth. This percentage is even higher, reaching 42% in more skeptical counties such as Woodward County (Sutter).

This astounding figure made me wonder why people doubted global warming. Perhaps the results found by the climate researchers in Oklahoma did not compel its citizens because they did not experience its effects, such as increasing temperatures and decreasing precipitation, for themselves in their day to day lives. To test my hypothesis, I collected temperature data for Oklahoma from 1920 - now and compared my results to the data published by associations such as The Oklahoma Climatological Survey (OCS) and The Environmental Protection Agency (EPA). What I found was that, unsurprisingly, Oklahoma’s average minimum and maximum temperatures are rising along with the global trend. Unfortunately, this finding on its own does not confirm the reason for Oklahoma’s skepticism; a deeper analysis of Oklahoma’s sociological make-up is needed to understand the exact causes of such strong climate change denial in this region. This attitude of doubt towards global warming must be halted as current adaptation methods will be insufficient in responding to the more intense consequences of climate change that are projected to arise. 

Last year marked the closing of the El Nino weather pattern. Regardless of this, scientists still predict temperature rises for the next 5 years. For Oklahoma, annual mean temperatures are expected to rise by approximately 2.5°F by 2040 (Karl). This number nearly doubles the 1.3°F increase in mean temperature that occurred between 1993 and 2008. In future summers, temperature increases are predicted to be slightly higher at 2.7 - 2.9°F. These predictions are backed up by EPA whose research also forecasts the number of days over 100°F  to quadruple by mid century. Although my data shows a trend that closely aligns to this prediction, there are substantial gaps in my data set. There is a lack of observations as concrete data has only been collected for the past 2 decades. Thus, future predictions cannot be perfect. 

##Average TMAX - May 
```{r May, echo=FALSE}
plot(TMAX~YEAR, data=MonthlyMean[MonthlyMean$Month=="05",], ty='l') 
May.lm <- lm(TMAX~YEAR, data=MonthlyMean[MonthlyMean$Month=="05",])

abline(coef(May.lm), col="red")
```

##Average TMAX - June 
```{r June, echo=FALSE}
plot(TMAX~YEAR, data=MonthlyMean[MonthlyMean$Month=="06",], ty='l') 
June.lm <- lm(TMAX~YEAR, data=MonthlyMean[MonthlyMean$Month=="06",])

abline(coef(June.lm), col="red")
```

Change (degrees / year) : `r coef(May.lm)[2]` 
Degrees / 100 years :  `r round(coef(May.lm)[2]*100, 3)` 
Probability of `r round(summary(May.lm)$coefficients[2,4],4)`. 

##Average TMAX - November 
```{r Nov, echo=FALSE}
plot(TMAX~YEAR, data=MonthlyMean[MonthlyMean$Month=="11",], ty='l') 
Nov.lm <- lm(TMAX~YEAR, data=MonthlyMean[MonthlyMean$Month=="11",])
abline(coef(Nov.lm), col="blue")

```

##Average TMAX - December
```{r Dec, echo=FALSE}
plot(TMAX~YEAR, data=MonthlyMean[MonthlyMean$Month=="12",], ty='l') 
Dec.lm <- lm(TMAX~YEAR, data=MonthlyMean[MonthlyMean$Month=="12",])
abline(coef(Dec.lm), col="blue")
```


```{r, echo=FALSE, results='hide'}
MonthlyMeanTMIN = aggregate(TMIN ~ Month + Year, LosAngeles, mean)

MonthlyMeanTMIN$YEAR = as.numeric(MonthlyMeanTMIN$Year)
head(MonthlyMeanTMIN)
```

##Average TMIN - November 
```{r Nov2, echo=FALSE}

plot(TMIN~YEAR, data=MonthlyMeanTMIN[MonthlyMeanTMIN$Month=="11",], ty='l') 
Nov.lm <- lm(TMIN~YEAR, data=MonthlyMeanTMIN[MonthlyMeanTMIN$Month=="11",])

abline(coef(Nov.lm), col="purple")

```

##Average TMIN - December 
```{r Dec2, echo=FALSE}
plot(TMIN~YEAR, data=MonthlyMeanTMIN[MonthlyMeanTMIN$Month=="12",], ty='l') 
Dec.lm <- lm(TMIN~YEAR, data=MonthlyMeanTMIN[MonthlyMeanTMIN$Month=="12",])
#summary(Dec.lm)

abline(coef(Dec.lm), col="purple")

```


Slope: `r coef(Dec.lm)[2]` 
probability: `r round(summary(Dec.lm)$coefficients[2,4],7)`
r-squared: `r round(summary(Dec.lm)$r.squared, 3)`. 

what do the r-squared and probability values mean? 
Is this formula replicable? If not, how can i find the slope of the trend line for each of my graphs? 

##Average TMIN - May 
```{r May2, echo=FALSE}
plot(TMIN~YEAR, data=MonthlyMeanTMIN[MonthlyMeanTMIN$Month=="05",], ty='l') 
May.lm <- lm(TMIN~YEAR, data=MonthlyMeanTMIN[MonthlyMeanTMIN$Month=="05",])
#summary(May.lm)

abline(coef(May.lm), col="orange")

```



##Average TMIN - June
```{r, echo=FALSE}
plot(TMIN~YEAR, data=MonthlyMeanTMIN[MonthlyMeanTMIN$Month=="06",], ty='l') 
June.lm <- lm(TMIN~YEAR, data=MonthlyMeanTMIN[MonthlyMeanTMIN$Month=="06",])
#summary(June.lm)

abline(coef(June.lm), col="orange")

```

##Precipitation


```{r, echo=FALSE}
LosAngeles$PRCP[LosAngeles$PRCP==-9999] <- NA
YearlySum = aggregate(PRCP ~ Year, LosAngeles, sum)
YearlySum$YEAR = as.numeric(YearlySum$Year) 
YearlyMean = mean(YearlySum$PRCP)
```

each dot is a yearly mean calculated from the sum of all rainfall recorded that year 

blue line = mean 

red line = trend line 

Precipitation declining at -0.0085364 cm yr$^{-1}~$ or -0.09cm decade$^{-1}$ 


```{r, echo=FALSE}
plot(PRCP~YEAR, data=YearlySum, las=1, ty="p")
abline(h=YearlyMean, col="blue")
YearlySum.lm = lm(PRCP~YEAR, data=YearlySum)
abline(coef(YearlySum.lm), col="red")

n <- 5 
k <- rep(1/n, n)
k

y_lag <- stats::filter(YearlySum$PRCP, k, sides=1)
#lines(YearlySum$YEAR, y_lag, col="red")
```






