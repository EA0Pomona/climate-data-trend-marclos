---
title: "Cape May Climate"
author: "Caroline Koh Smith"
date: "9/18/2017"
output: html_document
---
## Climate Change in Cape May, NJ

```{r intro, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
read.csv("/home/CAMPUS/ctsa2016/Climate_Change_Narratives/Student_Folders/Caroline_Koh_Smith/carolinekohsmith_capemay_data.csv")
climate_data <- read.csv("/home/CAMPUS/ctsa2016/Climate_Change_Narratives/Student_Folders/Caroline_Koh_Smith/carolinekohsmith_capemay_data.csv")
str(climate_data)
strDates <- as.character(climate_data$DATE)
climate_data$NewDate <- as.Date(strDates, "%Y-%m-%d")
str(climate_data)
head(climate_data)
```

Cape May County lies at the southernmost point of New Jersey, right where the Atlantic meets the Delaware River. It is a popular destination for both beachgoers and migrating fauna, as well as home to over 400 different species of animals (many of them endangered) and 94,000 residents. However, because of a changing climate, the communities living there and the sensitive ecology will be adversely affected. 

The first graph demonstrates the daily maximum temperatures from the 1890s to the present. The data is spread out because of Cape May's climate. The Köppen-Geiger measure of Southern New Jersey’s climate is a Cfa, meaning that the main climate is warm temperate (C), the precipitation is fully humid (f), and temperature is warm arid (a). That means that the temperature varies greatly from an average winter max of about 5 C and an average summer max of about 25 C. The line on this graph demonstrates a trend of warming by about 3 C: this was calculated by using the linear regression model of the data (y=(6.119e-05)(x)+(1.716e+01)) at the first date, January 1st, 1984, and the latest date, August 8th, 2017. The model shows a starting average temperature of 15.4615 C and an ending average temperature of 18.2252 C. 

If there were no correlation between the time and the increase in temperature, the linear model would not have any significance. However, the p-value for this model (which is the statistical certainty) is<2e-16, which is less than 0.05, demonstrating that there is a correlation.

```{r graphing, echo=FALSE}
##lm(TMAX ~ NewDate,data=climate_data)
climate.lm<- lm(formula = TMAX ~ NewDate, data = climate_data)
#plot(climate.lm)
#plot(lm(formula = TMAX ~ NewDate, data = climate_data))
plot(TMAX~NewDate, climate_data, ty="p", pch=20)
abline(coef(climate.lm), col="blue")
##as.numeric(min(climate_data$NewDate))*(6.119e-05)+1.716e+01
##as.numeric(max(climate_data$NewDate))*(6.119e-05)+1.716e+01
```

```{r, echo=FALSE}
climate_data$Month = format(as.Date(climate_data$NewDate), format = "%m")
climate_data$Year = format(climate_data$NewDate, format="%Y")
MonthlyTMAXMean = aggregate(TMAX ~ Month + Year, climate_data, mean)
MonthlyTMAXMean$YEAR = as.numeric(MonthlyTMAXMean$Year)
MonthlyTMAXMean$MONTH = as.numeric(MonthlyTMAXMean$Month)
##str(MonthlyTMAXMean)
MonthlyTMAXSD = aggregate(TMAX ~ Month + Year, climate_data, sd)
MonthlyTMAXSD$YEAR = as.numeric(MonthlyTMAXSD$Year)
MonthlyTMAXSD$MONTH = as.numeric(MonthlyTMAXSD$Month)
MonthlyTMAXSD$NewDate = MonthlyTMAXSD$YEAR + (MonthlyTMAXSD$MONTH - 1)/12
##head(MonthlyTMAXSD)
##plot(MonthlyTMAXMean$TMAX, ty='l')
##abline(coef(climate.lm), col="blue")
```

To make this data easier to understand, I've separated out the month of may and analyzed the trends for the average maximum temperature for every month of May from 1894 to 2017. May is an important month because that is when the horseshoe crabs go to the beaches of Cape May to spawn (I will discuss this further below). This makes the range of temperatures more concentrated as the average maximum temperature in May should be similar every year. Here you can also clearly see an increase in temperature of about 3 C. 

This can also be said with certainty as the model has a p value of 4.661e-06 which is also significantly less that 0.05. Note: The slope of this graph looks much steeper because the range of temperatures is far less than over the full year.

```{r, echo=FALSE}
plot(TMAX~YEAR, data=MonthlyTMAXMean[MonthlyTMAXMean$Month=="05",], ty='p', pch=20, main = "May")
May.lm <- lm(TMAX~YEAR, data=MonthlyTMAXMean[MonthlyTMAXMean$Month=="05",])
##summary(May.lm)
abline(coef(May.lm), col="blue")

```

From this data it is clear that the climate in Cape May is warming. But what does this mean?
Cape May, which is already very vulnerable to coastal storms such as hurricanes and nor’easters, will experience devastating flooding that will only be exacerbated because of the lack of flood control measures within the built environment. This will harm both the residents of the area and the sensitive ecosystems that are there. The natural environment is an amalgam of salt marshes, grasslands, hardwood swamps, forested uplands, and bogs home to 317 bird species, 42 mammal species, and 55 reptile and amphibian species. 

One of the most vulnerable species is the North American Horseshoe Crab, as the Delaware Bay is their spawning area. Horseshoe Crabs have medicinal properties in their blood which has resulted in them being over fished (as well as for bait). Their homes have been destroyed and will continue to be with overdevelopment and climate change affecting sea levels and water temperatures. Despite their species having lived for over 400 million years, their numbers are now being threatened. Spawning, which a good portion of is done in Cape May, is also being affected by beach erosion and geochemical factors, according to a 1988 paper by Botton et al. It determined that if ocean salinity, chemical composition of beaches, and beach erosion changes, horseshoe crab spawning will be far less successful as they prefer to spawn on beaches without sediment reduction to H2S. Moreover, some of the beaches will be completely destroyed by rising sea levels. 

Horseshoe crab spawning is not only important to their own populations, but also to populations of several endangered migrating birds who feed on the eggs. A 1994 Paper by Botton et al. demonstrates how shorebirds such as red knots, ruddy turnstones, and semipalmated sandpipers were all dependent on horseshoe crab eggs for feeding. With fewer horseshoe crabs, fewer of these birds, many of whom are endangered because of habitat destruction, will be able to survive. The paper states that “500,000 to 1.5 million shorebirds arrive on and depart from Delaware Bay beaches within a three to four-week period in the spring” to return to their arctic breeding grounds from equatorial regions in the winter. When they do not get enough to eat, they do not build enough fat to give them energy during their migration. 

I also have done the same analyses of the minimum themperatures, showing similar trends to the maximum. Here is the daily temperatures and a linear model, with a p-value of 2e-16, so the model is very accurate. 

```{r, echo=FALSE}
##climate.lm<- lm(formula = TMIN ~ NewDate, data = climate_data)
plot(TMIN~NewDate, climate_data, ty="p", pch=20)
abline(coef(climate.lm), col="blue")
##summary(lm(TMIN ~ NewDate,data=climate_data))
```

Here are the average minimum temperatures for the month of May. However, the P-value for this linear model is .191, which is greater than 0.05, so there is not enough significance to state a pattern of warming for average minimum temperatures of May.

```{r, echo=FALSE}
climate_data$Month = format(as.Date(climate_data$NewDate), format = "%m")
climate_data$Year = format(climate_data$NewDate, format="%Y")
MonthlyTMINMean = aggregate(TMIN ~ Month + Year, climate_data, mean)
MonthlyTMINMean$YEAR = as.numeric(MonthlyTMINMean$Year)
MonthlyTMINMean$MONTH = as.numeric(MonthlyTMINMean$Month)
##str(MonthlyTMINMean)
MonthlyTMINSD = aggregate(TMIN ~ Month + Year, climate_data, sd)
MonthlyTMINSD$YEAR = as.numeric(MonthlyTMINSD$Year)
MonthlyTMINSD$MONTH = as.numeric(MonthlyTMINSD$Month)
MonthlyTMINSD$NewDate = MonthlyTMINSD$YEAR + (MonthlyTMINSD$MONTH - 1)/12
##head(MonthlyTMINSD)
##plot(MonthlyTMINMean$TMIN, ty='l')
##abline(coef(climate.lm), col="blue")
plot(TMIN~YEAR, data=MonthlyTMINMean[MonthlyTMINMean$Month=="05",], ty='p', pch=20, main = "May")
Maymin.lm <- lm(TMIN~YEAR, data=MonthlyTMINMean[MonthlyTMINMean$Month=="05",])
##summary(Maymin.lm)
abline(coef(Maymin.lm), col="blue")
```

The primary paper of how climate change will affect Cape May is one titled “Vulnerability of coastal communities to sea-level rise: a case study of Cape May County, New Jersey, USA” by Wu et al. in 2002. It discusses how sea level rise will increase the effects of coastal storms by using GIS and analyzing the community and its built environment to determine the vulnerability of people living there from the effects of climate change. 25% of the population is over 65 years old8, which makes the population especially vulnerable as elderly people need more assistance when it comes to disaster relief and often are not able to remove themselves in time. The barrier islands have lower vulnerabilities because they tend to be second homes to wealthier beach goers, while inland is where the major vulnerabilities lie as those are the lower income areas. The percent of the population exposed to flood risk is constantly increasing, especially from inland flooding events. A large part of the Cape May industry is hospitality– if the places where people are coming to will be destroyed, those living there and working hospitality jobs will be economically devastated. However, this paper, as it stated, “ignored the potential impacts on the ecosystems of the county, which may not adapt as readily as people and their infrastructures”. Because a large attraction of the Cape May area is the wildlife and wildlife recreation, the destruction of the ecosystems could have a significant economic impact as well. 


``` {r, echo=FALSE}
##All of the graphs for the months
##TMAX
##Months = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")
##par(mfrow=c(4,3), mar=c(5,4,3,2)+0.1)
##TMAXresult <- NA
##for (i in 1:12){
##plot(TMAX~YEAR, data=MonthlyTMAXMean[MonthlyTMAXMean$MONTH==i,], ty='l', las=1, main=Months[i])
##Month.lm <- lm(TMAX~YEAR, data=MonthlyTMAXMean[MonthlyTMAXMean$MONTH==i,])
##summary(Month.lm)
##abline(coef(Month.lm), col="red")
##TMAXresult <- rbind(TMAXresult, cbind(Months[i], round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4],4), round(summary(Month.lm)$r.squared, 3)))}
##TMIN
##{Months = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")
##par(mfrow=c(4,3), mar=c(5,4,3,2)+0.1)
##TMINresult <- NA
##for (i in 1:12){
##plot(TMIN~YEAR, data=MonthlyTMINMean[MonthlyTMINMean$MONTH==i,], ty='l', las=1, main=Months[i])
##Month.lm <- lm(TMIN~YEAR, data=MonthlyTMINMean[MonthlyTMINMean$MONTH==i,])
##summary(Month.lm)
##abline(coef(Month.lm), col="red")
##TMINresult <- rbind(TMINresult, cbind(Months[i], round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4],4), round(summary(Month.lm)$r.squared, 3)))}}
##PRECIP
##TotalPPT <- aggregate(climate_data$PRCP, list(climate_data$Month, climate_data$Year), sum, na.rm=T)
##names(TotalPPT) = c("Month", "Year", "PRCP")
##TotalPPT$Date <- as.numeric(TotalPPT$Month)/12 + as.numeric(TotalPPT$Year)
##plot(PRCP~Date, data=TotalPPT, ty="p", pch=20)
##plot(PRCP~Date, data=TotalPPT[TotalPPT$Month=="05",], ty='p', pch=20, main = "May")
##MayPRCP.lm <- lm(PRCP~Date, data=TotalPPT[TotalPPT$Month=="05",])
##summary(Maymin.lm)
##abline(coef(MayPRCP.lm), col="red")