---
title: "Cape May Climate"
author: "Caroline Koh Smith"
date: "9/18/2017"
output: html_document
---
## Climate Change in Cape May, NJ

```{r intro, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
read.csv("/home/CAMPUS/ctsa2016/Climate_Change_Narratives/Student_Folders/Caroline_Koh_Smith/carolinekohsmith_capemay_data.csv")
climate_data <- read.csv("/home/CAMPUS/ctsa2016/Climate_Change_Narratives/Student_Folders/Caroline_Koh_Smith/carolinekohsmith_capemay_data.csv")
str(climate_data)
strDates <- as.character(climate_data$DATE)
climate_data$NewDate <- as.Date(strDates, "%Y-%m-%d")
str(climate_data)
head(climate_data)
```

This next section is a visual of this data demonstrating the change in Maximum temperature over the period of 1894 to the present time. There is a graph demonstrating the daily values of Maximumum temperature 





```{r graphing, echo=FALSE}
lm(TMAX ~ NewDate,data=climate_data)
climate.lm<- lm(formula = TMAX ~ NewDate, data = climate_data)
#plot(climate.lm)
#plot(lm(formula = TMAX ~ NewDate, data = climate_data))
plot(TMAX~NewDate, climate_data, ty="p", pch=20)
abline(coef(climate.lm), col="green")
```

```{r, echo=TRUE}
climate_data$Month = format(as.Date(climate_data$NewDate), format = "%m")
climate_data$Year = format(climate_data$NewDate, format="%Y")
MonthlyTMAXMean = aggregate(TMAX ~ Month + Year, climate_data, mean)
MonthlyTMAXMean$YEAR = as.numeric(MonthlyTMAXMean$Year)
MonthlyTMAXMean$MONTH = as.numeric(MonthlyTMAXMean$Month)
str(MonthlyTMAXMean)
MonthlyTMAXSD = aggregate(TMAX ~ Month + Year, climate_data, sd)
MonthlyTMAXSD$YEAR = as.numeric(MonthlyTMAXSD$Year)
MonthlyTMAXSD$MONTH = as.numeric(MonthlyTMAXSD$Month)
MonthlyTMAXSD$NewDate = MonthlyTMAXSD$YEAR + (MonthlyTMAXSD$MONTH - 1)/12
head(MonthlyTMAXSD)
plot(MonthlyTMAXMean$TMAX, ty='l')
abline(coef(climate.lm), col="green")
```
PLOT OF MAY
```{r, echo=TRUE}
plot(TMAX~YEAR, data=MonthlyTMAXMean[MonthlyTMAXMean$Month=="05",], ty='p', pch=20, main = "May")
May.lm <- lm(TMAX~YEAR, data=MonthlyTMAXMean[MonthlyTMAXMean$Month=="05",])
##summary(May.lm)
abline(coef(May.lm), col="red")

```

TMIN
```{r, echo=TRUE}
climate.lm<- lm(formula = TMIN ~ NewDate, data = climate_data)
plot(TMIN~NewDate, climate_data, ty="p", pch=20)
abline(coef(climate.lm), col="green")
```

```{r, echo=TRUE}
climate_data$Month = format(as.Date(climate_data$NewDate), format = "%m")
climate_data$Year = format(climate_data$NewDate, format="%Y")
MonthlyTMINMean = aggregate(TMIN ~ Month + Year, climate_data, mean)
MonthlyTMINMean$YEAR = as.numeric(MonthlyTMINMean$Year)
MonthlyTMINMean$MONTH = as.numeric(MonthlyTMINMean$Month)
##str(MonthlyTMINMean)
MonthlyTMINSD = aggregate(TMIN ~ Month + Year, climate_data, sd)
MonthlyTMINSD$YEAR = as.numeric(MonthlyTMINSD$Year)
MonthlyTMINSD$MONTH = as.numeric(MonthlyTMINSD$Month)
MonthlyTMINSD$NewDate = MonthlyTMINSD$YEAR + (MonthlyTMINSD$MONTH - 1)/12
##head(MonthlyTMINSD)
plot(MonthlyTMINMean$TMIN, ty='l')
abline(coef(climate.lm), col="green")
```
May Minimum
``` {r, echo=TRUE}
plot(TMIN~YEAR, data=MonthlyTMINMean[MonthlyTMINMean$Month=="05",], ty='p', pch=20, main = "May")
Maymin.lm <- lm(TMIN~YEAR, data=MonthlyTMINMean[MonthlyTMINMean$Month=="05",])
##summary(Maymin.lm)
abline(coef(Maymin.lm), col="red")
```
Precip

``` {r, echo=TRUE}
TotalPPT <- aggregate(climate_data$PRCP, list(climate_data$Month, climate_data$Year), sum, na.rm=T)
names(TotalPPT) = c("Month", "Year", "PRCP")
TotalPPT$Date <- as.numeric(TotalPPT$Month)/12 + as.numeric(TotalPPT$Year)
plot(PRCP~Date, data=TotalPPT, ty="p", pch=20)
```
``` {r, echo=TRUE}
plot(PRCP~Date, data=TotalPPT[TotalPPT$Month=="05",], ty='p', pch=20, main = "May")
MayPRCP.lm <- lm(PRCP~Date, data=TotalPPT[TotalPPT$Month=="05",])
summary(Maymin.lm)
abline(coef(MayPRCP.lm), col="red")
```

``` {r, echo=TRUE}
##All of the graphs for the months
##TMAX
##Months = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")
##par(mfrow=c(4,3), mar=c(5,4,3,2)+0.1)
##TMAXresult <- NA
##for (i in 1:12){
##plot(TMAX~YEAR, data=MonthlyTMAXMean[MonthlyTMAXMean$MONTH==i,], ty='l', las=1, main=Months[i])
##Month.lm <- lm(TMAX~YEAR, data=MonthlyTMAXMean[MonthlyTMAXMean$MONTH==i,])
##summary(Month.lm)
##abline(coef(Month.lm), col="red")
##TMAXresult <- rbind(TMAXresult, cbind(Months[i], round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4],4), round(summary(Month.lm)$r.squared, 3)))}
##TMIN
##{Months = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")
##par(mfrow=c(4,3), mar=c(5,4,3,2)+0.1)
##TMINresult <- NA
##for (i in 1:12){
##plot(TMIN~YEAR, data=MonthlyTMINMean[MonthlyTMINMean$MONTH==i,], ty='l', las=1, main=Months[i])
##Month.lm <- lm(TMIN~YEAR, data=MonthlyTMINMean[MonthlyTMINMean$MONTH==i,])
##summary(Month.lm)
##abline(coef(Month.lm), col="red")
##TMINresult <- rbind(TMINresult, cbind(Months[i], round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4],4), round(summary(Month.lm)$r.squared, 3)))}}